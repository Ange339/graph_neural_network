09-06 15:04:07 - INFO - __main__ - Configuration:
09-06 15:04:07 - INFO - __main__ - {'batch_method': 'binary_link_neighbors',
 'batch_norm': False,
 'batch_size': 128,
 'book_features': [{'degree_log_transform': True,
                    'features': ['degree', 'coreness'],
                    'name': 'topo'},
                   {'name': 'textual_desc'},
                   {'aggr_fn': 'mean', 'name': 'textual_reviews'}],
 'books_filename': 'books_filtered.parquet',
 'coreness_k': 10,
 'decoder': 'inner_product_decoder',
 'descriptions_filename': 'descriptions_filtered.parquet',
 'dir': '../data_sample',
 'disjoint_train_ratio': 0.0,
 'dropout': 0.5,
 'embeddings_descriptions_filename': 'embeddings_descriptions_sbert_pt.parquet',
 'embeddings_reviews_filename': 'embeddings_reviews_sbert_pt.parquet',
 'encoder': 'sage_encoder',
 'epochs': 0,
 'eval_interval': 2,
 'feature_aggr_method': 'concat',
 'feature_linear_dim': 64,
 'hidden_channels': 32,
 'interactions_filename': 'interactions.parquet',
 'item_emb_dim': 64,
 'item_feature_linear': True,
 'kl_beta': 1.0,
 'kl_warmup_epoch': 50,
 'language_filter': True,
 'latent_dim': 16,
 'learning_rate': 0.01,
 'n_layer': 1,
 'negative_sampling_method': 'pairwise_random',
 'negative_sampling_ratio': 1.0,
 'negative_sampling_recurrence': 'epoch',
 'num_neighbors': [10, 10],
 'opt_decay_rate': 0.1,
 'opt_decay_step': 20,
 'patience': 50,
 'recon_loss': 'bpr',
 'review_coreness_k': 5,
 'reviews_filename': 'reviews_filtered.parquet',
 'save_model': False,
 'seed': 42,
 'skip_connection': False,
 'test_size': 0.1,
 'user_emb_dim': 64,
 'user_feature_linear': True,
 'user_features': [{'degree_log_transform': True,
                    'features': ['degree', 'coreness'],
                    'name': 'topo'},
                   {'aggr_fn': 'mean', 'name': 'textual_reviews'}],
 'users_filename': 'users_filtered.parquet',
 'val_size': 0.1,
 'weight_decay': 1e-05}
09-06 15:04:12 - INFO - src.data_loader - Initial size. Users: 43807, Books: 236065, Total: 279872, Edges: 1134132, Density: 0.010967%
09-06 15:04:12 - INFO - src.data_loader - Filtered size. Users: 1494, Books: 1373, Total: 2867, Edges: 72538, Density: 3.536262%
09-06 15:04:12 - INFO - src.data_loader - Initial textual embeddings size. Descriptions: 1373, Reviews: 17932, Total: 19305
09-06 15:04:12 - INFO - src.data_loader - Filtered textual embeddings size. Descriptions: 1373, Reviews: 17132, Total: 18505
09-06 15:04:12 - DEBUG - __main__ - Train: HeteroData(
  user={
    node_id=[1494],
    x=[1494, 386],
  },
  item={
    node_id=[1373],
    x=[1373, 770],
  },
  (user, interacts, item)={
    edge_index=[2, 58032],
    edge_label=[58032],
    edge_label_index=[2, 58032],
  },
  (item, rev_interacts, user)={ edge_index=[2, 58032] }
)
09-06 15:04:12 - DEBUG - __main__ - Val: HeteroData(
  user={
    node_id=[1494],
    x=[1494, 386],
  },
  item={
    node_id=[1373],
    x=[1373, 770],
  },
  (user, interacts, item)={
    edge_index=[2, 58032],
    edge_label=[14506],
    edge_label_index=[2, 14506],
  },
  (item, rev_interacts, user)={ edge_index=[2, 58032] }
)
09-06 15:04:12 - DEBUG - __main__ - Test: HeteroData(
  user={
    node_id=[1494],
    x=[1494, 386],
  },
  item={
    node_id=[1373],
    x=[1373, 770],
  },
  (user, interacts, item)={
    edge_index=[2, 65285],
    edge_label=[14506],
    edge_label_index=[2, 14506],
  },
  (item, rev_interacts, user)={ edge_index=[2, 65285] }
)
09-06 15:04:12 - DEBUG - root - Inferred 'filter_per_worker=True' option for feature fetching routines of the data loader
09-06 15:04:12 - DEBUG - model - Input channels: (128, 128), Hidden channels: 32, Latent dim: 16
09-06 15:04:13 - INFO - root - Model summary:
09-06 15:04:13 - INFO - root - VGAE(
  (user_embedding): Embedding(1494, 64)
  (item_embedding): Embedding(1373, 64)
  (user_feature_linear): Linear(in_features=386, out_features=64, bias=True)
  (item_feature_linear): Linear(in_features=770, out_features=64, bias=True)
  (encoder): GraphModule(
    (convs): ModuleList(
      (0): ModuleDict(
        (user__interacts__item): SAGEConv((-1, -1), 32, aggr=mean)
        (item__rev_interacts__user): SAGEConv((-1, -1), 32, aggr=mean)
      )
    )
    (conv_mu): ModuleDict(
      (user__interacts__item): SAGEConv(32, 16, aggr=mean)
      (item__rev_interacts__user): SAGEConv(32, 16, aggr=mean)
    )
    (conv_logvar): ModuleDict(
      (user__interacts__item): SAGEConv(32, 16, aggr=mean)
      (item__rev_interacts__user): SAGEConv(32, 16, aggr=mean)
    )
  )
  (decoder): InnerProductDecoder()
)
09-06 15:04:16 - INFO - __main__ - Best model found at epoch 0, Val Loss: inf, AUC: 0.00%, AP: 0.00%
09-06 15:04:16 - INFO - __main__ - Done
